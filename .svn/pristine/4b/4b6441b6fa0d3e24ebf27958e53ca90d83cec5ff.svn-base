#include "MainPage.h"

using namespace Wt;

mainPage::mainPage(dbo::ptr<userAccount> user) : Wt::WContainerWidget(), user_(user) {
    this->initElems();

    auto clicked_main = [this]{
        this->main_page_.emit(true);
    };
    auto clicked_exit = [this]{
        this->logged_out_.emit(true);
    };
    auto clicked_menu_one = [this]{
        this->menu_one_.emit(true);
    };
    auto clicked_two_one = [this]{
        this->menu_two_.emit(true);
    };
    auto clicked_three_one = [this]{
        this->menu_three_.emit(true);
    };

    ((Wt::WPushButton *)this->main_menu_->widget(0))->clicked().connect(clicked_main);
    ((Wt::WPushButton *)this->main_menu_->widget(1))->clicked().connect(clicked_menu_one);
    ((Wt::WPushButton *)this->main_menu_->widget(2))->clicked().connect(clicked_two_one);
    ((Wt::WPushButton *)this->main_menu_->widget(3))->clicked().connect(clicked_three_one);
    ((Wt::WPushButton *)this->main_menu_->widget(4))->clicked().connect(clicked_exit);
}

void mainPage::initElems(void) {
    this->setStyleClass("centered");

    
    this->user_name_wdgt_ = this->addWidget(createButton("topnav-a-username", "USername: " + this->user_->name));
    this->user_name_wdgt_->setDisabled(true);
    
    this->main_menu_ = this->addNew<Wt::WToolBar>();
    this->main_menu_->setStyleClass("topnav");
    this->main_menu_->addButton(createButton("topnav-a", "MAIN MENU"));
    this->main_menu_->addButton(createButton("topnav-a", "MENU_1"));
    this->main_menu_->addButton(createButton("topnav-a", "MENU_2"));
    this->main_menu_->addButton(createButton("topnav-a", "MENU_3"));
    this->main_menu_->addButton(createButton("topnav-a", "EXIT"));
    
}

std::unique_ptr<Wt::WPushButton> mainPage::createButton(const char * style, const Wt::WString& name) {
    auto button = std::make_unique<Wt::WPushButton>();
    button->setTextFormat(Wt::TextFormat::XHTML);
    button->setText(name);
    button->addStyleClass(style);
    return button;
}

void mainPage::setMainPageContent(void) {
    this->addWidget(std::make_unique<Wt::WText>("<br></br>"));
    this->addWidget(std::make_unique<Wt::WText>("<h1> MAIN PAGE </h1>"));
    this->addWidget(std::make_unique<Wt::WText>("<b> Username: " + this->user_->name + "</b>"));
}

void mainPage::setMenuOneContent() {
    this->addWidget(std::make_unique<Wt::WText>("<br></br>"));
    this->addWidget(std::make_unique<Wt::WText>("<h1> MENU ONE </h1>"));
    this->addWidget(std::make_unique<Wt::WText>("<b> Username: " + this->user_->name + "</b>"));
}

void mainPage::setMenuTwoContent(void) {
    this->addWidget(std::make_unique<Wt::WText>("<br></br>"));
    this->addWidget(std::make_unique<Wt::WText>("<h1> MENU TWO </h1>"));
    this->addWidget(std::make_unique<Wt::WText>("<b> Username: " + this->user_->name + "</b>"));
}

void mainPage::setMenuThreeContent(void) {
    this->addWidget(std::make_unique<Wt::WText>("<br></br>"));
    this->addWidget(std::make_unique<Wt::WText>("<h1> MENU THREE </h1>"));
    this->addWidget(std::make_unique<Wt::WText>("<b> Username: " + this->user_->name + "</b>"));
}
